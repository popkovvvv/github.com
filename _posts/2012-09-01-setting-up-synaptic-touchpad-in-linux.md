---
layout: post
title: "Настройка тачпада synaptic в Linux"
tags : [programming]
---

С тех пор как у меня появился ноутбук, меня не покидало чувство, что что-то не так с настройками тачпада. Окончательно я в этом убедился, когда пощупал тачпад на макбуке. Проблема в том, что в Linux настройки тачпада одинаковые, а характеристики тачпадов разные. Сейчас я расскажу как сделать тачпад более удобным в работе. Система автора Ubuntu 12.04 на Dell e6520. Данные советы должны подойти для других debian-based дистрибутивов.

----------------------------

Первая и самая главная проблема с настройкой чувствительности тачпада. Первым делом необходимо проанализировать среднюю силу нажатия с помощью программы synclient.
После выполнения`synclient -m 50` запустится мониторинг событий тачпада и выглядит он следующим образом:

    time     x    y   z f  w  l r u d m     multi  gl gm gr gdx gdy
    0.000  1518 1011   0 0  0  0 0 0 0 0  00000000
    0.901  1546  188 105 1  0  0 0 0 0 0  00000000
    1.002  1416  243 110 1  0  0 0 0 0 0  00000000
    1.102  1473  481 110 1  0  0 0 0 0 0  00000000
    1.202  1750  433 105 1  0  0 0 0 0 0  00000000
    1.302  1600  284 116 1  0  0 0 0 0 0  00000000
    1.402  1265  564 115 1  0  0 0 0 0 0  00000000
    1.503   992  902 114 1  0  0 0 0 0 0  00000000
    1.603   819  545 113 1  0  0 0 0 0 0  00000000
    1.703  1130  363 113 1  0  0 0 0 0 0  00000000
    1.803  1302  791 113 1  0  0 0 0 0 0  00000000
    1.903  1002  853 118 1  0  0 0 0 0 0  00000000
    2.003   970  433 117 1  0  0 0 0 0 0  00000000
    2.104  1314  376 112 1  0  0 0 0 0 0  00000000
    2.204  1342  705 113 1  0  0 0 0 0 0  00000000
    2.304   971  893 115 1  0  0 0 0 0 0  00000000
    2.404   950  486 117 1  0  0 0 0 0 0  00000000
    2.504  1267  385 113 1  0  0 0 0 0 0  00000000
    2.604  1367  522 112 1  0  0 0 0 0 0  00000000
    2.704  1118  603 115 1  0  0 0 0 0 0  00000000

`x` и `y` --- координаты на тачпаде, `z` --- сила нажатия, `f` --- количество пальцев на тачпаде. 


Среднюю силу нажатия можно определить на глаз или с помощью скрипта. Для этого определите файл, в который будет осуществляться вывод `synclient`: наберите в терминале `OUTPUT_FILE="synclient.log"`. Затем выполните `synclient -m 50 > $OUTPUT_FILE` и поработайте некоторое время в своём нормальном темпе. Остановите работу данной команды и выполните следующий скрипт, чтобы получить среднюю силу нажатия:

{% highlight bash %}

LOWER_LIMIT=20; SYNCLIENT_PRESSURE=`cat $OUTPUT_FILE | awk '{print $4}' | tr -d "z" | 
grep -v '^$' | tr "\n" " "`; COUNT=0; SUM=0; for i in $(echo $SYNCLIENT_PRESSURE | 
tr " " "\n"); do; if [ $i -gt $LOWER_LIMIT ]; then; COUNT=$(( $COUNT+1 )); 
SUM=$(( $i  + $SUM )); fi; done;  AVERAGE=$(( $SUM / $COUNT)); echo "Average pressure is $AVERAGE"

{% endhighlight %}

В моём случае скрипт выдал следующее `Average pressure is 102`. Будем считать, что средним значением будет 100.

Если судить по `man synaptics`, то за детектирование касания по тачпаду отвечают 2 параметра: `FingerHigh` и `FingerLow`. `FingerHigh` --- указывает на давление, начиная с которого нужно детектировать касание, a `FingerLow` --- то давление, начиная с которого считать касание по тачпаду завершенным. Установим `FingerHigh` равным среднему значению давления на тачпад: `synclient FingerHigh=100`. `FingerLow` сделаем близким к `FingerHigh`: `synclient FingerLow=85`. Данные изменения вступают в силу немедленно и можно достаточно быстро подобрать оптимальные значения.

------------------------------

Следующая задача --- настроить скорость движения. За это отвечают 2 параметра `MinSpeed` и `MaxSpeed`. У меня они выставлены на `synclient MinSpeed=1.8` и `synclient MaxSpeed=2.5`. В зависимости от того, с какой скоростью вы двигаете по тачпаду, скорость будет колебаться от `MinSpeed` до `MaxSpeed`. Это значит, что если требуется убрать акселерацию, то нужно выставить этим параметрам равные значения. Настройку я сделал на глаз.

Для того, чтобы драйвер живее реагировал на одиночное касание (Tap) нужно выставить `synclient FastTaps=1`. Предотвратить случайные нажатия можно с помощью `synclient PalmDetect=1`
 (если поддерживается тачпадом).

------------------------------

Теперь, чтобы не вводить данные параметры при каждой перезагрузке, их нужно поместить в `$HOME/.xsessionrc`.  
На этом настройка тачпада закончена. В дальнейшем поможет `man synaptics` ;-)



